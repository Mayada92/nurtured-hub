---
import Badge from './Badge.astro';
import type { CollectionEntry } from 'astro:content';

interface Props {
  course: CollectionEntry<'courses'>;
}

const { course } = Astro.props;
const { data } = course;
const isRTL = data.lang === 'ar';

const domainLabels = {
  en: {
    sports: 'Sports',
    'educational-psychology': 'Educational Psychology',
    engineering: 'Engineering',
    'data-science': 'Data Science',
  },
  ar: {
    sports: 'الرياضة',
    'educational-psychology': 'علم النفس التربوي',
    engineering: 'الهندسة',
    'data-science': 'علم البيانات',
  },
};

const levelLabels = {
  en: {
    undergraduate: 'Undergraduate',
    graduate: 'Graduate',
    professional: 'Professional',
    certification: 'Certification',
  },
  ar: {
    undergraduate: 'بكالوريوس',
    graduate: 'دراسات عليا',
    professional: 'مهني',
    certification: 'شهادة',
  },
};
---

<article class="course-card">
  {data.cover && (
    <div class="course-card__cover">
      <img
        src={data.cover}
        alt={`${data.title} - Course certificate`}
        loading="lazy"
        width="600"
        height="400"
        decoding="async"
      />
    </div>
  )}
  <header>
    <h3>{data.title}</h3>
    {data.course_code && <span class="course-code">{data.course_code}</span>}
    <div class="course-card__meta">
      <span class="institution">{data.institution}</span>
      {data.level && (
        <Badge label={levelLabels[data.lang][data.level]} variant="accent-4" size="sm" />
      )}
    </div>
    <div class="course-card__details">
      {data.term && <span class="term">{data.term}</span>}
      <span class="year">{data.year}</span>
      {data.credits && <span class="credits">{data.credits} {isRTL ? 'ساعة' : 'credits'}</span>}
    </div>
    <div class="course-card__domain">
      <Badge label={domainLabels[data.lang][data.domain]} variant="accent-1" size="sm" />
    </div>
  </header>
  <p>{data.description}</p>
  {data.syllabus_url && (
    <footer>
      <a href={data.syllabus_url} target="_blank" rel="noopener noreferrer">
        {isRTL ? 'المنهج ←' : 'Syllabus →'}
      </a>
    </footer>
  )}
</article>

<style>
  .course-card {
    background: var(--gradient-card);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-card);
    transition: all var(--motion-duration-normal) var(--motion-easing-smooth);
    border: 1px solid rgba(0, 0, 0, 0.05);
    overflow: hidden;
  }

  .course-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-card-hover);
  }

  .course-card__cover {
    width: 100%;
    height: 200px;
    overflow: hidden;
    background: var(--gradient-section);
  }

  .course-card__cover img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform var(--motion-duration-slow) var(--motion-easing-smooth);
  }

  .course-card:hover .course-card__cover img {
    transform: scale(1.1);
  }

  .course-card header {
    padding: var(--space-6);
  }

  .course-code {
    display: inline-block;
    font-family: 'Courier New', monospace;
    font-size: 0.875rem;
    color: var(--color-muted-ink);
    background: var(--color-accent-4);
    padding: var(--space-1) var(--space-2);
    border-radius: var(--radius-sm);
    margin-block-end: var(--space-2);
  }

  .course-card__meta {
    display: flex;
    gap: var(--space-2);
    align-items: center;
    margin-block-end: var(--space-2);
  }

  .institution {
    font-weight: 600;
    color: var(--color-ink);
  }

  .course-card__details {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-3);
    margin-block-end: var(--space-3);
    font-size: var(--font-size-small);
    color: var(--color-muted-ink);
  }

  .course-card__domain {
    margin-block-end: var(--space-4);
  }

  footer {
    margin-block-start: var(--space-4);
  }

  footer a {
    text-decoration: none;
    font-weight: 500;
  }
</style>

