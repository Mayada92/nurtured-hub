---
import Badge from './Badge.astro';
import type { CollectionEntry } from 'astro:content';

interface Props {
  volunteering: CollectionEntry<'volunteering'>;
}

const { volunteering } = Astro.props;
const { data } = volunteering;
const isRTL = data.lang === 'ar';
const dateFormat = isRTL ? 'ar-SA' : 'en-US';
const startDate = new Date(data.start_date).toLocaleDateString(dateFormat, {
  year: 'numeric',
  month: 'short',
});
const endDate = data.end_date
  ? new Date(data.end_date).toLocaleDateString(dateFormat, {
      year: 'numeric',
      month: 'short',
    })
  : null;

const domainLabels = {
  en: {
    sports: 'Sports',
    'educational-psychology': 'Educational Psychology',
    engineering: 'Engineering',
    'data-science': 'Data Science',
    general: 'General',
  },
  ar: {
    sports: 'الرياضة',
    'educational-psychology': 'علم النفس التربوي',
    engineering: 'الهندسة',
    'data-science': 'علم البيانات',
    general: 'عام',
  },
};
---

<article class="volunteering-card">
  {data.cover && (
    <div class="volunteering-card__cover">
      <img
        src={data.cover}
        alt={`${data.title} - Cover image`}
        loading="lazy"
        width="600"
        height="400"
        decoding="async"
      />
    </div>
  )}
  <header>
    <h3>{data.title}</h3>
    <div class="volunteering-card__meta">
      <span class="organization">{data.organization}</span>
      {data.is_hackathon && (
        <Badge label={isRTL ? 'هاكاثون' : 'Hackathon'} variant="accent-2" size="sm" />
      )}
    </div>
    <div class="volunteering-card__details">
      <span class="role">{data.role}</span>
      <span class="date">
        {startDate} {data.ongoing ? (isRTL ? '- حتى الآن' : '- Present') : endDate ? ` - ${endDate}` : ''}
      </span>
    </div>
    <div class="volunteering-card__domains">
      {data.domain.map((d) => (
        <Badge label={domainLabels[data.lang][d]} variant="accent-1" size="sm" />
      ))}
    </div>
  </header>
  <p>{data.description}</p>
  {data.achievements && data.achievements.length > 0 && (
    <ul class="achievements">
      {data.achievements.map((achievement) => (
        <li>{achievement}</li>
      ))}
    </ul>
  )}
  {data.skills && data.skills.length > 0 && (
    <div class="volunteering-card__skills">
      {data.skills.map((skill) => (
        <Badge label={skill} variant="accent-3" size="sm" />
      ))}
    </div>
  )}
  {data.url && (
    <footer>
      <a href={data.url} target="_blank" rel="noopener noreferrer">
        {isRTL ? 'الموقع الإلكتروني ←' : 'Website →'}
      </a>
    </footer>
  )}
</article>

<style>
  .volunteering-card {
    background: var(--gradient-card);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-card);
    transition: all var(--motion-duration-normal) var(--motion-easing-smooth);
    border: 1px solid rgba(0, 0, 0, 0.05);
    overflow: hidden;
    margin-block-end: var(--space-3);
  }

  .volunteering-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-card-hover);
  }

  .volunteering-card__cover {
    width: 100%;
    height: 200px;
    overflow: hidden;
    background: var(--gradient-section);
  }

  .volunteering-card__cover img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform var(--motion-duration-slow) var(--motion-easing-smooth);
  }

  .volunteering-card:hover .volunteering-card__cover img {
    transform: scale(1.1);
  }

  .volunteering-card header {
    padding: var(--space-4);
  }

  .volunteering-card > p {
    padding: 0 var(--space-4);
  }

  .volunteering-card .achievements,
  .volunteering-card .volunteering-card__skills {
    padding: 0 var(--space-4);
  }

  .volunteering-card footer {
    padding: 0 var(--space-4) var(--space-4);
  }

  .volunteering-card__meta {
    display: flex;
    gap: var(--space-2);
    align-items: center;
    margin-block-end: var(--space-2);
  }

  .organization {
    font-weight: 600;
    color: var(--color-ink);
  }

  .volunteering-card__details {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-3);
    margin-block-end: var(--space-3);
    font-size: var(--font-size-small);
    color: var(--color-muted-ink);
  }

  .volunteering-card__domains {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
    margin-block-end: var(--space-4);
  }

  .achievements {
    list-style: none;
    padding-inline-start: var(--space-4);
    margin-block: var(--space-4);
  }

  .achievements li {
    position: relative;
    padding-inline-start: var(--space-4);
    margin-block-end: var(--space-2);
  }

  .achievements li::before {
    content: '•';
    position: absolute;
    inset-inline-start: 0;
    color: var(--color-accent-1);
    font-weight: bold;
  }

  footer {
    margin-block-start: var(--space-4);
  }

  footer a {
    text-decoration: none;
    font-weight: 500;
  }

  .volunteering-card__skills {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
    margin-block-start: var(--space-4);
  }
</style>

