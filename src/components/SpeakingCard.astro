---
import Badge from './Badge.astro';
import type { CollectionEntry } from 'astro:content';

interface Props {
  speaking: CollectionEntry<'speaking'>;
}

const { speaking } = Astro.props;
const { data } = speaking;
const isRTL = data.lang === 'ar';
const dateFormat = isRTL ? 'ar-SA' : 'en-US';
const date = new Date(data.date).toLocaleDateString(dateFormat, {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});

const typeLabels = {
  en: {
    talk: 'Talk',
    presentation: 'Presentation',
    panel: 'Panel',
    keynote: 'Keynote',
    webinar: 'Webinar',
  },
  ar: {
    talk: 'محاضرة',
    presentation: 'عرض تقديمي',
    panel: 'جلسة نقاش',
    keynote: 'خطاب رئيسي',
    webinar: 'ندوة عبر الإنترنت',
  },
};

const domainLabels = {
  en: {
    sports: 'Sports',
    'educational-psychology': 'Educational Psychology',
    engineering: 'Engineering',
    'data-science': 'Data Science',
    general: 'General',
  },
  ar: {
    sports: 'الرياضة',
    'educational-psychology': 'علم النفس التربوي',
    engineering: 'الهندسة',
    'data-science': 'علم البيانات',
    general: 'عام',
  },
};
---

<article class="speaking-card">
  <header>
    <h3>{data.title}</h3>
    <div class="speaking-card__meta">
      <Badge label={typeLabels[data.lang][data.type]} variant="accent-2" size="sm" />
      <span class="event">{data.event}</span>
    </div>
    <div class="speaking-card__details">
      {data.venue && <span class="venue">{data.venue}</span>}
      <span class="date">{date}</span>
    </div>
    <div class="speaking-card__domains">
      {data.domain.map((d) => (
        <Badge label={domainLabels[data.lang][d]} variant="accent-1" size="sm" />
      ))}
    </div>
  </header>
  <p>{data.description}</p>
  <footer class="speaking-card__links">
    {data.event_url && (
      <a href={data.event_url} target="_blank" rel="noopener noreferrer">
        {isRTL ? 'الحدث ←' : 'Event →'}
      </a>
    )}
    {data.recording_url && (
      <a href={data.recording_url} target="_blank" rel="noopener noreferrer">
        {isRTL ? 'التسجيل ←' : 'Recording →'}
      </a>
    )}
    {data.slides_url && (
      <a href={data.slides_url} target="_blank" rel="noopener noreferrer">
        {isRTL ? 'العروض ←' : 'Slides →'}
      </a>
    )}
  </footer>
</article>

<style>
  .speaking-card {
    background: var(--gradient-card);
    padding: var(--space-6);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-card);
    transition: all var(--motion-duration-normal) var(--motion-easing-smooth);
    border: 1px solid rgba(0, 0, 0, 0.05);
  }

  .speaking-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-card-hover);
  }

  .speaking-card__meta {
    display: flex;
    gap: var(--space-2);
    align-items: center;
    margin-block-end: var(--space-2);
  }

  .event {
    font-weight: 600;
    color: var(--color-ink);
  }

  .speaking-card__details {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-3);
    margin-block-end: var(--space-3);
    font-size: var(--font-size-small);
    color: var(--color-muted-ink);
  }

  .speaking-card__domains {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
    margin-block-end: var(--space-4);
  }

  .speaking-card__links {
    display: flex;
    gap: var(--space-4);
    margin-block-start: var(--space-4);
  }

  .speaking-card__links a {
    text-decoration: none;
    font-weight: 500;
  }
</style>

