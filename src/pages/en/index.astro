---
import BaseLayout from '../../layouts/BaseLayout.astro';
import FloatingLayer from '../../components/FloatingLayer';
import SectionReveal from '../../components/SectionReveal';
import ImageStage from '../../components/ImageStage';
import ProjectCard from '../../components/ProjectCard.astro';
import PostCard from '../../components/PostCard.astro';
import StatsSection from '../../components/StatsSection';
import Icon from '../../components/Icon.astro';
import { getCollection } from 'astro:content';
import { getBasePath, getImagePath } from '../../utils/path';

const base = getBasePath();

const featuredProjects = (await getCollection('projects'))
  .filter((p) => p.data.lang === 'en' && p.data.featured)
  .slice(0, 6)
  .sort((a, b) => b.data.year - a.data.year);

const recentPosts = (await getCollection('posts'))
  .filter((p) => p.data.lang === 'en')
  .slice(0, 3)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime());

// Calculate actual stats from content
const allProjects = await getCollection('projects');
const allPapers = await getCollection('papers');
const allWork = await getCollection('work');

// Calculate years of experience (from 2017 when started at Saudi Aramco to now)
const workStartYear = 2017; // Started at Saudi Aramco in October 2017
const currentYear = new Date().getFullYear();
const yearsExperience = currentYear - workStartYear;

// Count projects (English only for display)
const projectCount = allProjects.filter((p) => p.data.lang === 'en').length;

// Count publications/papers
const paperCount = allPapers.filter((p) => p.data.lang === 'en').length;

// Domains are fixed: sports, educational-psychology, engineering, data-science
const domainCount = 4;

const stats = [
  { number: yearsExperience.toString(), label: 'Years Experience' },
  { number: projectCount.toString(), label: 'Projects' },
  { number: paperCount.toString(), label: 'Publications' },
  { number: domainCount.toString(), label: 'Domains' },
];
---

<BaseLayout
  title="Home"
  description="Welcome to Nurtured Hub - A bilingual portfolio showcasing projects, writing, and professional profiles"
  lang="en"
>
  <div style="position: relative; min-height: 100vh;">
    <FloatingLayer client:load />
    <section class="hero">
      <div class="hero__background">
        <img src={getImagePath('/images/hero/kaaba-serenity.jpg')} alt="" aria-hidden="true" />
        <div class="hero__overlay"></div>
        <div class="hero__gradient"></div>
      </div>
      <div class="container">
        <SectionReveal client:load>
          <div class="hero__content">
            <div class="hero__logo">
              <img src={getImagePath('/images/brand/nurtured-mind-logo.jpg')} alt="Nurtured Hub" width="180" height="180" />
            </div>
            <div class="hero__badge">Maya Alhashem | Engineer • Data Scientist • EdTech Innovator</div>
            <h1>Welcome to Nurtured Hub</h1>
            <p class="hero__subtitle">
              A multidisciplinary portfolio exploring the intersection of engineering, data science, and education. 
              Bridging technical expertise with human-centered innovation.
            </p>
            <div class="hero__pathways">
              <h2 class="hero__pathways-title">Explore by Pathway</h2>
              <div class="hero__pathways-grid">
                <a href={`${base}en/profile/engineering`.replace(/\/+/g, '/')} class="pathway-button pathway-button--engineering">
                  <Icon name="code" size={20} />
                  <div class="pathway-button__content">
                    <span class="pathway-button__title">Engineering Pathway</span>
                    <span class="pathway-button__desc">Mechanical & chemical engineering, ESP optimization, flow assurance, patents & hardware innovation</span>
                  </div>
                </a>
                <a href={`${base}en/profile/data-science`.replace(/\/+/g, '/')} class="pathway-button pathway-button--data-science">
                  <Icon name="chart" size={20} />
                  <div class="pathway-button__content">
                    <span class="pathway-button__title">Data Science Pathway</span>
                    <span class="pathway-button__desc">Advanced ML techniques, educational data analytics, predictive modeling & data-driven solutions</span>
                  </div>
                </a>
                <a href={`${base}en/profile/children-education`.replace(/\/+/g, '/')} class="pathway-button pathway-button--education">
                  <Icon name="book" size={20} />
                  <div class="pathway-button__content">
                    <span class="pathway-button__title">Education Pathway</span>
                    <span class="pathway-button__desc">Children's education research, data analysis, innovative teaching methods & developmental milestones</span>
                  </div>
                </a>
              </div>
            </div>
            <div class="hero__quick-links">
              <a href={`${base}en/projects`.replace(/\/+/g, '/')} class="quick-link">
                <Icon name="folder" size={18} />
                <span>All Projects</span>
              </a>
              <a href={`${base}en/writing`.replace(/\/+/g, '/')} class="quick-link">
                <Icon name="document" size={18} />
                <span>Blog</span>
              </a>
              <a href={`${base}en/papers`.replace(/\/+/g, '/')} class="quick-link">
                <Icon name="academic" size={18} />
                <span>Publications</span>
              </a>
            </div>
          </div>
        </SectionReveal>
      </div>
    </section>

    <section class="section section--stats">
      <div class="container">
        <StatsSection client:load stats={stats} />
      </div>
    </section>

    <section class="section section--story">
      <div class="container">
        <div class="story-grid">
          <SectionReveal client:load delay={0.1}>
            <div class="story-content">
              <h2>Driven by Data, Powered by Purpose</h2>
              <p>
                I use data science and engineering to solve complex problems and create impactful solutions. 
                From educational psychology to machine learning pipelines, my work bridges multiple domains 
                to drive meaningful change.
              </p>
              <p>
                Explore my portfolio to see how curiosity, data, and purpose converge in projects that 
                span education, technology, and social impact.
              </p>
            </div>
          </SectionReveal>
          <SectionReveal client:load delay={0.2}>
            <div class="story-image">
              <ImageStage 
                src={getImagePath('/images/brand/nurtured-mind-logo.jpg')} 
                alt="Nurtured Hub visual"
                width={600}
                height={600}
                parallax={true}
              />
            </div>
          </SectionReveal>
        </div>
      </div>
    </section>

    <section class="section section--projects">
      <div class="container">
        <SectionReveal client:load delay={0.1}>
          <div class="section-header">
            <h2>Featured Projects</h2>
            <p class="section-subtitle">Whether it's data engineering, analysis, or machine learning, my work is rooted in purpose.</p>
          </div>
          <div class="grid grid--projects">
            {featuredProjects.map((project, i) => (
              <SectionReveal client:load delay={0.1 + i * 0.1}>
                <ProjectCard project={project} />
              </SectionReveal>
            ))}
          </div>
        </SectionReveal>
      </div>
    </section>

    <section class="section section--writing">
      <div class="container">
        <SectionReveal client:load delay={0.2}>
          <div class="section-header">
            <h2>Recent Writing</h2>
            <p class="section-subtitle">Thoughts, insights, and learnings from my journey across domains.</p>
          </div>
          <div class="grid grid--posts">
            {recentPosts.map((post, i) => (
              <SectionReveal client:load delay={0.2 + i * 0.1}>
                <PostCard post={post} />
              </SectionReveal>
            ))}
          </div>
        </SectionReveal>
      </div>
    </section>

    <section class="section section--banner">
      <div class="container">
        <SectionReveal client:load delay={0.3}>
          <div class="banner">
            <div class="banner__logo">
              <img src={`${base}images/brand/nurtured-mind-logo.jpg`.replace(/\/+/g, '/')} alt="Nurtured Hub" width="120" height="120" />
            </div>
            <h2>Nurtured Hub</h2>
            <p>
              A platform for exploring the intersection of education, data, and social impact.
              Bridging perspectives through research, writing, and practical applications.
            </p>
          </div>
        </SectionReveal>
      </div>
    </section>
  </div>
</BaseLayout>

<style>
  .hero {
    position: relative;
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding-block: var(--space-8);
    overflow: hidden;
  }

  .hero__background {
    position: absolute;
    inset: 0;
    z-index: 0;
  }

  .hero__background img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0.4;
    filter: blur(2px) brightness(0.85) saturate(1.2);
    transform: scale(1.1);
    animation: heroZoom 30s ease-in-out infinite alternate;
  }

  @keyframes heroZoom {
    0% {
      transform: scale(1.1) translateX(0);
    }
    100% {
      transform: scale(1.15) translateX(2%);
    }
  }

  .hero__background:hover img {
    filter: blur(1px) brightness(0.9) saturate(1.3);
  }

  .hero__overlay {
    position: absolute;
    inset: 0;
    background: var(--gradient-hero);
    z-index: 1;
    opacity: 0.6;
  }

  .hero__gradient {
    position: absolute;
    inset: 0;
    background: var(--gradient-overlay);
    z-index: 1;
    pointer-events: none;
  }

  .hero__content {
    position: relative;
    z-index: 2;
    max-width: var(--hero-content-width);
    margin-inline: auto;
  }

  .hero__logo {
    margin-block-end: var(--space-6);
    display: flex;
    justify-content: center;
  }

  .hero__logo img {
    width: 180px;
    height: 180px;
    object-fit: contain;
    filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.1));
  }

  .hero__badge {
    display: inline-block;
    padding: var(--space-2) var(--space-4);
    background: rgba(255, 255, 255, 0.9);
    border: 1px solid rgba(26, 26, 26, 0.1);
    border-radius: var(--radius-xl);
    font-size: 0.6125rem;
    font-weight: 600;
    letter-spacing: 0.05em;
    text-transform: uppercase;
    color: var(--color-muted-ink);
    margin-block-end: var(--space-6);
    backdrop-filter: blur(10px);
  }

  .hero h1 {
    font-size: clamp(1.4rem, 3.5vw, 2.5rem);
    font-weight: 700;
    line-height: 1.1;
    margin-block-end: var(--space-6);
    letter-spacing: -0.03em;
    background: var(--gradient-text);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: gradientShift 8s ease-in-out infinite;
    background-size: 200% 200%;
  }

  @keyframes gradientShift {
    0%, 100% {
      background-position: 0% 50%;
    }
    50% {
      background-position: 100% 50%;
    }
  }

  .hero__subtitle {
    font-size: clamp(0.7875rem, 1.4vw, 0.9625rem);
    color: var(--color-ink);
    margin-block-end: var(--space-8);
    max-width: var(--hero-content-width);
    margin-inline: auto;
    line-height: 1.7;
    font-weight: 400;
    opacity: 0.9;
  }

  .hero__pathways {
    margin-block: var(--space-8);
  }

  .hero__pathways-title {
    font-size: 0.875rem;
    font-weight: 600;
    text-align: center;
    margin-block-end: var(--space-4);
    color: var(--color-ink);
  }

  .hero__pathways-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--space-3);
    margin-block-end: var(--space-6);
  }

  .pathway-button {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-3) var(--space-4);
    background: rgba(255, 255, 255, 0.95);
    border: 2px solid rgba(0, 0, 0, 0.08);
    border-radius: var(--radius-lg);
    text-decoration: none;
    transition: all var(--motion-duration-normal) var(--motion-easing-smooth);
    box-shadow: var(--shadow-card);
    position: relative;
    overflow: hidden;
  }

  .pathway-button::before {
    content: '';
    position: absolute;
    inset: 0;
    opacity: 0;
    transition: opacity var(--motion-duration-normal) var(--motion-easing-smooth);
    z-index: 0;
  }

  .pathway-button:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-card-hover);
    border-color: transparent;
  }

  .pathway-button:hover::before {
    opacity: 1;
  }

  .pathway-button svg {
    flex-shrink: 0;
    z-index: 1;
    position: relative;
    width: 20px;
    height: 20px;
  }

  .pathway-button__content {
    display: flex;
    flex-direction: column;
    gap: 0.125rem;
    z-index: 1;
    position: relative;
    flex: 1;
    min-width: 0;
  }

  .pathway-button__title {
    font-size: 0.7rem;
    font-weight: 600;
    color: var(--color-ink);
    transition: color var(--motion-duration-fast) var(--motion-easing);
    line-height: 1.2;
    white-space: nowrap;
  }

  .pathway-button__desc {
    font-size: 0.525rem;
    color: var(--color-muted-ink);
    transition: color var(--motion-duration-fast) var(--motion-easing);
    line-height: 1.3;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
  }

  .pathway-button:hover .pathway-button__title,
  .pathway-button:hover .pathway-button__desc {
    color: white;
  }

  .pathway-button--engineering::before {
    background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);
  }

  .pathway-button--data-science::before {
    background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
  }

  .pathway-button--education::before {
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
  }

  .hero__quick-links {
    display: flex;
    gap: var(--space-4);
    justify-content: center;
    flex-wrap: wrap;
    padding-block-start: var(--space-4);
    border-block-start: 1px solid rgba(0, 0, 0, 0.08);
  }

  .quick-link {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-2) var(--space-4);
    color: var(--color-muted-ink);
    text-decoration: none;
    font-size: 0.65625rem;
    border-radius: var(--radius-md);
    transition: all var(--motion-duration-fast) var(--motion-easing);
  }

  .quick-link:hover {
    color: var(--color-ink);
    background: rgba(0, 0, 0, 0.04);
  }

  .hero__cta {
    display: flex;
    gap: var(--space-3);
    justify-content: center;
    flex-wrap: wrap;
  }

  .cta-button {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-4) var(--space-8);
    background: white;
    border: 2px solid transparent;
    border-radius: var(--radius-xl);
    text-decoration: none;
    font-weight: 600;
    font-size: 0.74375rem;
    letter-spacing: -0.01em;
    transition: all var(--motion-duration-normal) var(--motion-easing-smooth);
    box-shadow: var(--shadow-soft);
    position: relative;
    overflow: hidden;
  }

  .cta-button svg {
    flex-shrink: 0;
  }

  .cta-button::before {
    content: '';
    position: absolute;
    inset: 0;
    background: var(--gradient-button);
    opacity: 0;
    transition: opacity var(--motion-duration-normal) var(--motion-easing-smooth);
    z-index: -1;
  }

  .cta-button:hover {
    transform: translateY(-4px) scale(1.03);
    color: white;
    box-shadow: var(--shadow-button-hover);
    border-color: transparent;
  }

  .cta-button:hover::before {
    opacity: 1;
  }

  .cta-button--profile {
    background: linear-gradient(135deg, #8b5cf6 0%, #a78bfa 100%);
    color: white;
    border-color: transparent;
    box-shadow: 0 4px 14px rgba(139, 92, 246, 0.3);
  }

  .cta-button--profile::before {
    background: linear-gradient(135deg, #7c3aed 0%, #9333ea 100%);
  }

  .cta-button--profile:hover {
    transform: translateY(-4px) scale(1.03);
    box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4);
  }

  .cta-button--projects {
    background: linear-gradient(135deg, #06b6d4 0%, #22d3ee 100%);
    color: white;
    border-color: transparent;
    box-shadow: 0 4px 14px rgba(6, 182, 212, 0.3);
  }

  .cta-button--projects::before {
    background: linear-gradient(135deg, #0891b2 0%, #0e7490 100%);
  }

  .cta-button--projects:hover {
    transform: translateY(-4px) scale(1.03);
    box-shadow: 0 6px 20px rgba(6, 182, 212, 0.4);
  }

  .cta-button--articles {
    background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%);
    color: white;
    border-color: transparent;
    box-shadow: 0 4px 14px rgba(245, 158, 11, 0.3);
  }

  .cta-button--articles::before {
    background: linear-gradient(135deg, #d97706 0%, #b45309 100%);
  }

  .cta-button--articles:hover {
    transform: translateY(-4px) scale(1.03);
    box-shadow: 0 6px 20px rgba(245, 158, 11, 0.4);
  }

  .section {
    padding-block: var(--section-spacing);
  }

  .section--stats {
    background: var(--gradient-section);
    padding-block: var(--space-12);
    border-radius: var(--radius-xl);
    margin-block: var(--section-spacing);
    position: relative;
    overflow: hidden;
  }

  .section--stats::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.2) 0%, transparent 70%);
    pointer-events: none;
  }

  .section--story {
    padding-block: var(--space-12);
  }

  .story-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-10);
    align-items: center;
  }

  .story-content h2 {
    font-size: var(--font-size-h1);
    font-weight: 700;
    line-height: 1.2;
    margin-block-end: var(--space-6);
    letter-spacing: -0.02em;
    color: var(--color-ink);
  }

  .story-content p {
    font-size: var(--font-size-body);
    line-height: 1.8;
    color: var(--color-muted-ink);
    margin-block-end: var(--space-4);
  }

  .story-image {
    position: relative;
  }

  .section--banner {
    background: var(--gradient-section);
    padding-block: var(--space-6);
    border-radius: var(--radius-xl);
    margin-block: var(--section-spacing);
    position: relative;
    overflow: hidden;
  }

  .section--banner::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at 30% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
    pointer-events: none;
  }

  .banner {
    text-align: center;
    color: var(--color-ink);
    max-width: 700px;
    margin-inline: auto;
  }

  .banner__logo {
    margin-block-end: var(--space-3);
  }

  .banner__logo img {
    width: 80px;
    height: 80px;
    object-fit: contain;
    border-radius: var(--radius-lg);
    opacity: 0.8;
  }

  .grid {
    display: grid;
    gap: var(--space-6);
  }

  .grid--projects {
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: var(--space-8);
  }

  .grid--posts {
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: var(--space-8);
  }

  .section-header {
    text-align: center;
    margin-block-end: var(--space-10);
  }

  .section-header h2 {
    font-size: var(--font-size-h1);
    font-weight: 700;
    line-height: 1.2;
    letter-spacing: -0.02em;
    color: var(--color-ink);
    margin-block-end: var(--space-4);
    position: relative;
  }

  .section-header h2::before {
    content: '';
    display: block;
    width: 60px;
    height: 4px;
    background: linear-gradient(90deg, var(--color-accent-1), var(--color-accent-2));
    border-radius: 2px;
    margin: 0 auto var(--space-6);
    opacity: 0.8;
  }

  .section-subtitle {
    font-size: 0.875rem;
    line-height: 1.6;
    color: var(--color-muted-ink);
    max-width: 600px;
    margin-inline: auto;
  }

  .section--projects,
  .section--writing {
    position: relative;
  }

  .section--projects::before,
  .section--writing::before {
    content: '';
    position: absolute;
    inset-block-start: 0;
    inset-inline-start: 50%;
    transform: translateX(-50%);
    width: 200px;
    height: 200px;
    background: radial-gradient(circle, var(--color-accent-1) 0%, transparent 70%);
    opacity: 0.1;
    filter: blur(60px);
    pointer-events: none;
  }

  @media (max-width: 968px) {
    .hero__pathways-grid {
      grid-template-columns: 1fr;
      gap: var(--space-2);
    }
    
    .story-grid {
      grid-template-columns: 1fr;
      gap: var(--space-8);
    }
  }

  @media (max-width: 768px) {
    .hero {
      min-height: 85vh;
      padding-block: var(--space-6);
    }

    .hero h1 {
      font-size: clamp(1.2rem, 4vw, 1.8rem);
    }

    .hero__subtitle {
      font-size: 0.7875rem;
    }

    .section {
      padding-block: var(--section-spacing-mobile);
    }

    .section--stats {
      padding-block: var(--space-8);
    }

    .story-grid {
      grid-template-columns: 1fr;
    }

    .grid--projects,
    .grid--posts {
      grid-template-columns: 1fr;
      gap: var(--space-6);
    }
  }
</style>



